<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>{{ page.title }} | {{ site.title }}</title>
  <meta name="description" content="{{ page.description | default: site.description }}"/>
  {% seo %}
  <link rel="stylesheet" href="{{ site.baseurl }}/assets/css/site.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to content</a>
  <div class="layout">
    <aside class="sidebar" role="complementary" aria-label="Sidebar navigation">
      <div class="brand">üè¥‚Äç‚ò†Ô∏è {{ site.title }}</div>
      <nav class="nav" role="navigation" aria-label="Primary">
  <a href="{{ site.baseurl }}/" class="nav-root" {% if page.url == '/' %}aria-current="page"{% endif %}>Home</a>
        {%- comment -%}
          Navigation that exactly mirrors the README structure
        {%- endcomment -%}
        <div class="nav-section">
          <div class="nav-section-title">Info About Steam Deck</div>
          <ul>
            <li><a href="{{ site.baseurl }}/docs/info" class="{% if page.url == '/docs/info' %}active{% endif %}" {% if page.url == '/docs/info' %}aria-current="page"{% endif %}>Overview</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/info#game-mode">Game Mode</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/info#desktop-mode">Desktop Mode</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/info#wine">Wine</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/info#proton">Proton</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/info#prefixes">Prefixes</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/info#launchers">Launchers</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/info#decky-plugins">Decky Plugins</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Apps you NEED TO have installed</div>
          <ul>
            <li><a href="{{ site.baseurl }}/docs/apps" class="{% if page.url == '/docs/apps' %}active{% endif %}" {% if page.url == '/docs/apps' %}aria-current="page"{% endif %}>Apps you NEED TO have installed</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Guides for installing games</div>
          <ul>
            <li><a href="{{ site.baseurl }}/docs/installing-games" class="{% if page.url == '/docs/installing-games' %}active{% endif %}" {% if page.url == '/docs/installing-games' %}aria-current="page"{% endif %}>Overview</a></li>
            <li><a href="{{ site.baseurl }}/docs/installing-through-steam" class="{% if page.url == '/docs/installing-through-steam' %}active{% endif %}" {% if page.url == '/docs/installing-through-steam' %}aria-current="page"{% endif %}>Installing games through Steam</a></li>
            <li><a href="{{ site.baseurl }}/docs/installing-through-lutris" class="{% if page.url == '/docs/installing-through-lutris' %}active{% endif %}" {% if page.url == '/docs/installing-through-lutris' %}aria-current="page"{% endif %}>Installing games through Lutris</a></li>
            <li><a href="{{ site.baseurl }}/docs/other-launchers" class="{% if page.url == '/docs/other-launchers' %}active{% endif %}" {% if page.url == '/docs/other-launchers' %}aria-current="page"{% endif %}>Installing games through other launchers</a></li>
            <li><a href="{{ site.baseurl }}/docs/transferring-from-pc" class="{% if page.url == '/docs/transferring-from-pc' %}active{% endif %}" {% if page.url == '/docs/transferring-from-pc' %}aria-current="page"{% endif %}>Transferring Installed Games from PC</a></li>
          </ul>
        </div>
        <div class="nav-section" data-section="proton">
          <div class="nav-section-title"><button class="nav-section-toggle" type="button" aria-expanded="true" aria-label="Collapse section">‚Äì</button> Guides for Proton/Wine</div>
          <ul>
            <li><a href="{{ site.baseurl }}/docs/proton-wine" class="{% if page.url == '/docs/proton-wine' %}active{% endif %}" {% if page.url == '/docs/proton-wine' %}aria-current="page"{% endif %}>Overview</a></li>
            <li><a href="{{ site.baseurl }}/docs/finding-proton-folder" class="{% if page.url == '/docs/finding-proton-folder' %}active{% endif %}" {% if page.url == '/docs/finding-proton-folder' %}aria-current="page"{% endif %}>Finding Proton Folder</a></li>
            <li><a href="{{ site.baseurl }}/docs/installing-dependencies" class="{% if page.url == '/docs/installing-dependencies' %}active{% endif %}" {% if page.url == '/docs/installing-dependencies' %}aria-current="page"{% endif %}>Installing Dependencies</a></li>
            <li><a href="{{ site.baseurl }}/docs/adding-dlls" class="{% if page.url == '/docs/adding-dlls' %}active{% endif %}" {% if page.url == '/docs/adding-dlls' %}aria-current="page"{% endif %}>Adding DLLs</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Guides for emulators and roms</div>
          <ul>
            <li><a href="{{ site.baseurl }}/docs/emulation-overview" class="{% if page.url == '/docs/emulation-overview' %}active{% endif %}" {% if page.url == '/docs/emulation-overview' %}aria-current="page"{% endif %}>Overview</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/emulation-overview#why-use-frontends">Why Use Frontends</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/emulation-overview#installing-emudeck">EmuDeck</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/emulation-overview#installing-retrodeck">RetroDeck</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/emulation-overview#individual-emulators-vs-frontends">Individual emulators</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/emulation-overview#switch-emulation">Switch Emulation</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/emulation-overview#bios-roms-and-other-files">BIOS, ROMs, and other files</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/emulation-overview#pc-ports-vs-emulation">PC Ports</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Cracks/DLC/Updates</div>
          <ul>
            <li><a href="{{ site.baseurl }}/docs/cracks-dlc-updates" class="{% if page.url == '/docs/cracks-dlc-updates' %}active{% endif %}" {% if page.url == '/docs/cracks-dlc-updates' %}aria-current="page"{% endif %}>Cracks/DLC/Updates</a></li>
          </ul>
        </div>
        <div class="nav-section" data-section="common">
          <div class="nav-section-title"><button class="nav-section-toggle" type="button" aria-expanded="true" aria-label="Collapse section">‚Äì</button> Common Questions</div>
          <ul>
            <li><a href="{{ site.baseurl }}/docs/common-questions" class="{% if page.url == '/docs/common-questions' %}active{% endif %}" {% if page.url == '/docs/common-questions' %}aria-current="page"{% endif %}>Overview</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#compressed-files">Compressed Files</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#iso-files">ISO Files</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#install-locations">Install Locations</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#cant-see-external-hddsd-cardhome-folder">Can't see external HDD/SD Card</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#cant-find-save-files">Can't find save files</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#how-do-i-movebackup-my-save-files">Move/backup save files</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#controller-not-working">Controller not working</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#game-opens-steam">Game opens steam</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#no-licenses">No licenses</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#games-suddenly-wont-open-or-close">Games won't open</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#game-tries-to-load-and-immediately-stops">Game stops immediately</a></li>
            <li class="small"><a href="{{ site.baseurl }}/docs/common-questions#mods-wont-load">Mods won't load</a></li>
          </ul>
        </div>
      </nav>
      <footer class="sidebar-footer">
        <a href="https://github.com/{{ site.github.owner_name }}/{{ site.github.repository_name }}">GitHub</a>
      </footer>
    </aside>
    <main class="content">
      <header class="topbar" role="banner">
        <div class="page-title">{{ page.title }}</div>
        <button class="menu-toggle-btn" id="menuToggle" type="button" aria-label="Toggle navigation" aria-expanded="false">‚ò∞ Menu</button>
        <div class="theme-toggle">
          <button id="themeToggle" type="button" aria-label="Toggle color theme">
            <span class="icon">üåô</span>
            <span class="label">Dark</span>
          </button>
        </div>
        <script>
          (function(){
            const STORAGE_KEY = 'sdp-theme';
            const mql = window.matchMedia('(prefers-color-scheme: dark)');
            const prefersDark = mql.matches;
            const saved = localStorage.getItem(STORAGE_KEY);
            const applied = saved || (prefersDark ? 'dark' : 'light');
            if(applied === 'light') document.documentElement.setAttribute('data-theme','light');
            function setTheme(mode){
              if(mode === 'light') document.documentElement.setAttribute('data-theme','light');
              else document.documentElement.removeAttribute('data-theme');
              localStorage.setItem(STORAGE_KEY,mode);
              const btn = document.getElementById('themeToggle');
              if(btn){
                const isLight = mode==='light';
                btn.querySelector('.icon').textContent = isLight ? '‚òÄÔ∏è' : 'üåô';
                btn.querySelector('.label').textContent = isLight ? 'Light' : 'Dark';
              }
            }
            window.__setTheme = setTheme;
            document.addEventListener('DOMContentLoaded',()=>{
              const btn = document.getElementById('themeToggle');
              if(!btn) return;
              btn.addEventListener('click',()=>{
                const current = document.documentElement.getAttribute('data-theme')==='light' ? 'light':'dark';
                setTheme(current==='light'?'dark':'light');
              });
              setTheme(applied);
            });
            // Live respond to system changes if user hasn't explicitly chosen
            mql.addEventListener('change', e => {
              if(!localStorage.getItem(STORAGE_KEY)){
                setTheme(e.matches ? 'dark' : 'light');
              }
            });
          })();
        </script>
      </header>
      <article id="main-content" class="doc markdown-body">{{ content }}</article>
      <button id="backToTop" type="button" aria-label="Back to top">Top</button>
      <script>
        // Mobile sidebar toggle + collapsible sections + scroll state
        (function(){
          const toggle = document.getElementById('menuToggle');
          const sidebar = document.querySelector('.sidebar');
          if(!toggle || !sidebar) return;
          toggle.addEventListener('click',()=>{
            const open = sidebar.classList.toggle('open');
            toggle.setAttribute('aria-expanded',open?'true':'false');
            document.body.classList.toggle('nav-open',open);
          });
          document.addEventListener('keydown',e=>{ if(e.key==='Escape' && sidebar.classList.contains('open')){ sidebar.classList.remove('open'); document.body.classList.remove('nav-open'); toggle.setAttribute('aria-expanded','false'); }});
          // collapsible
          const sectionStatesKey = 'sdp-section-states';
            let states = {};
            try{ states = JSON.parse(localStorage.getItem(sectionStatesKey)||'{}'); }catch(_){states={}};
          document.querySelectorAll('.nav-section').forEach(sec=>{
            const id = sec.getAttribute('data-section');
            const btn = sec.querySelector('.nav-section-toggle');
            if(!btn || !id) return;
            if(states[id] === 'collapsed'){
              sec.classList.add('collapsed');
              btn.setAttribute('aria-expanded','false');
              btn.textContent = '+';
            }
            btn.addEventListener('click',()=>{
              const collapsed = sec.classList.toggle('collapsed');
              btn.setAttribute('aria-expanded', collapsed ? 'false':'true');
              btn.textContent = collapsed ? '+' : '‚Äì';
              states[id] = collapsed ? 'collapsed':'expanded';
              localStorage.setItem(sectionStatesKey, JSON.stringify(states));
            });
          });
          // preserve sidebar scroll
          const scrollKey = 'sdp-sidebar-scroll';
          sidebar.scrollTop = +(localStorage.getItem(scrollKey)||0);
          sidebar.addEventListener('scroll',()=>{ localStorage.setItem(scrollKey, sidebar.scrollTop); });
        })();
        // Scroll spy + back to top
        (function(){
          const backBtn = document.getElementById('backToTop');
          backBtn.addEventListener('click',()=>{ window.scrollTo({top:0,behavior:'smooth'}); });
          const headings = Array.from(document.querySelectorAll('.doc h2, .doc h3, .doc h4'))
            .filter(h=>h.id);
          const linkMap = new Map();
          const navLinks = document.querySelectorAll('.nav a[href*="#"], .nav a[aria-current="page"]');
            navLinks.forEach(a=>{ try { const hash = decodeURIComponent(a.getAttribute('href').split('#')[1]||''); if(hash){ linkMap.set(hash,a);} } catch(_){} });
          let activeId = null;
          const observer = new IntersectionObserver(entries=>{
            entries.forEach(entry=>{
              if(entry.isIntersecting){ activeId = entry.target.id; update(); }
            });
          },{ rootMargin:'-55% 0px -40% 0px', threshold:[0,1]});
          function update(){
            navLinks.forEach(a=>a.classList.remove('spy-active'));
            if(activeId && linkMap.has(activeId)){
              const link = linkMap.get(activeId);
              link.classList.add('spy-active');
              link.setAttribute('aria-current','true');
            }
          }
          headings.forEach(h=>observer.observe(h));
          window.addEventListener('scroll',()=>{
            const y = window.scrollY || document.documentElement.scrollTop;
            if(y>400) backBtn.classList.add('visible'); else backBtn.classList.remove('visible');
          });
        })();
        // Transform GitHub style admonitions inside blockquotes beginning with [!TAG]
        (function(){
          const map = { NOTE:'note', WARNING:'warning', CAUTION:'caution', TIP:'tip', IMPORTANT:'important' };
          document.querySelectorAll('.markdown-body blockquote').forEach(bq=>{
            const first = bq.firstElementChild || bq.firstChild;
            if(!first) return;
            const text = (first.textContent||'').trim();
            const m = text.match(/^\[(?:!)([A-Z]+)]/);
            if(m){
              const key = m[1];
              const kind = map[key];
              if(kind){
                bq.classList.add('admonition', 'admonition-'+kind);
                // Remove the marker from first node
                first.textContent = first.textContent.replace(/^\[!([A-Z]+)]\s*/,'');
                const label = document.createElement('div');
                label.className='admonition-title';
                const title = key.charAt(0)+key.slice(1).toLowerCase();
                label.textContent = title;
                bq.insertBefore(label, bq.firstChild);
              }
            }
          });
        })();
      </script>
    </main>
  </div>
</body>
</html>
